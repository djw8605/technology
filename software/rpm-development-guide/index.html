



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://opensciencegrid.github.io/technology/software/rpm-development-guide/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.4">
    
    
      
        <title>RPM Development Guide - OSG Technology Area</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#rpm-development-guide" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://opensciencegrid.github.io/technology/" title="OSG Technology Area" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                OSG Technology Area
              </span>
              <span class="md-header-nav__topic">
                RPM Development Guide
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/opensciencegrid/technology/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://opensciencegrid.github.io/technology/" title="OSG Technology Area" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    OSG Technology Area
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/opensciencegrid/technology/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Software
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Software
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1" checked>
    
    <label class="md-nav__link" for="nav-2-1">
      Packaging
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Packaging
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        RPM Development Guide
      </label>
    
    <a href="./" title="RPM Development Guide" class="md-nav__link md-nav__link--active">
      RPM Development Guide
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#principles" title="Principles" class="md-nav__link">
    Principles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing-packages" title="Contributing Packages" class="md-nav__link">
    Contributing Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-infrastructure" title="Development Infrastructure" class="md-nav__link">
    Development Infrastructure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upstream-source-cache" title="Upstream Source Cache" class="md-nav__link">
    Upstream Source Cache
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#locating-files-in-the-cache" title="Locating Files in the Cache" class="md-nav__link">
    Locating Files in the Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributing-upstream-files" title="Contributing Upstream Files" class="md-nav__link">
    Contributing Upstream Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitgithub-hosted-upstream-files" title="Git/GitHub Hosted Upstream Files" class="md-nav__link">
    Git/GitHub Hosted Upstream Files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revision-control-system" title="Revision Control System" class="md-nav__link">
    Revision Control System
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#subversion-access" title="Subversion Access" class="md-nav__link">
    Subversion Access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#osg-owned-software" title="OSG-Owned Software" class="md-nav__link">
    OSG-Owned Software
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging-top-level-directory-organization" title="Packaging Top-Level Directory Organization" class="md-nav__link">
    Packaging Top-Level Directory Organization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#package-directory-organization" title="Package Directory Organization" class="md-nav__link">
    Package Directory Organization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#readme" title="README" class="md-nav__link">
    README
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upstream" title="upstream" class="md-nav__link">
    upstream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cached-files" title="Cached files" class="md-nav__link">
    Cached files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-repos" title="GitHub repos" class="md-nav__link">
    GitHub repos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-repos" title="Git repos" class="md-nav__link">
    Git repos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typical-workflow-when-building-out-of-github-repos" title="Typical workflow when building out of GitHub repos" class="md-nav__link">
    Typical workflow when building out of GitHub repos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-features-for-git-and-github-repos" title="Advanced features for Git and GitHub repos" class="md-nav__link">
    Advanced features for Git and GitHub repos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#osg" title="osg" class="md-nav__link">
    osg
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generated-directories" title="Generated directories" class="md-nav__link">
    Generated directories
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#95upstream95srpm95contents" title="_upstream_srpm_contents" class="md-nav__link">
    _upstream_srpm_contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95upstream95tarball95contents" title="_upstream_tarball_contents" class="md-nav__link">
    _upstream_tarball_contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95final95srpm95contents" title="_final_srpm_contents" class="md-nav__link">
    _final_srpm_contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95build95results" title="_build_results" class="md-nav__link">
    _build_results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95quilt" title="_quilt" class="md-nav__link">
    _quilt
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging-organization-examples" title="Packaging Organization Examples" class="md-nav__link">
    Packaging Organization Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case-1-packaging-an-upstream-source-tarball" title="Use Case 1: Packaging an Upstream Source Tarball" class="md-nav__link">
    Use Case 1: Packaging an Upstream Source Tarball
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case-2-passing-through-a-source-rpm" title="Use Case 2: Passing Through a Source RPM" class="md-nav__link">
    Use Case 2: Passing Through a Source RPM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case-3-modifying-a-source-rpm" title="Use Case 3: Modifying a Source RPM" class="md-nav__link">
    Use Case 3: Modifying a Source RPM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-process" title="Build Process" class="md-nav__link">
    Build Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#osg-software-repository" title="OSG Software Repository" class="md-nav__link">
    OSG Software Repository
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-levels" title="Release Levels" class="md-nav__link">
    Release Levels
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-conventions" title="Packaging Conventions" class="md-nav__link">
    Packaging Conventions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-for-multiple-distro-versions" title="Packaging for Multiple Distro Versions" class="md-nav__link">
    Packaging for Multiple Distro Versions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditionalizing-spec-files" title="Conditionalizing spec files" class="md-nav__link">
    Conditionalizing spec files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renaming-or-removing-packages" title="Renaming or Removing Packages" class="md-nav__link">
    Renaming or Removing Packages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dummying-out-a-package" title="Dummying out a package" class="md-nav__link">
    Dummying out a package
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../osg-build-tools/" title="OSG Build Tools" class="md-nav__link">
      OSG Build Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../quilt/" title="Using Quilt" class="md-nav__link">
      Using Quilt
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upcoming-to-main/" title="Upcoming to Main" class="md-nav__link">
      Upcoming to Main
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-workflow/" title="Koji Workflow" class="md-nav__link">
      Koji Workflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../create-vo-client/" title="Creating the VO Client Package" class="md-nav__link">
      Creating the VO Client Package
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../repository-management/" title="Repository Management" class="md-nav__link">
      Repository Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../globus-mass-update-procedure/" title="Globus Mass Update Procedure" class="md-nav__link">
      Globus Mass Update Procedure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../resurrecting-epel-packages/" title="Resurrecting Epel Packages" class="md-nav__link">
      Resurrecting Epel Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../koji-mass-rebuilds/" title="Koji Mass Rebuilds" class="md-nav__link">
      Koji Mass Rebuilds
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../development-process/" title="Development Process" class="md-nav__link">
      Development Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../git-software-development/" title="Git Software Development Process" class="md-nav__link">
      Git Software Development Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ce-test-scaling/" title="CE Scale Testing" class="md-nav__link">
      CE Scale Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ipv6-testing/" title="IPv6 Testing" class="md-nav__link">
      IPv6 Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/software-support/" title="Software Support" class="md-nav__link">
      Software Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../effort-tracking/" title="Effort Tracking" class="md-nav__link">
      Effort Tracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../release-planning/" title="Release Planning" class="md-nav__link">
      Release Planning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../new-team-member/" title="New Team Member" class="md-nav__link">
      New Team Member
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Release
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Release
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/cut-sw-release/" title="How to Cut a Release" class="md-nav__link">
      How to Cut a Release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/cut-data-release/" title="How to Cut a Data Release" class="md-nav__link">
      How to Cut a Data Release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/new-release-series/" title="New Release Series" class="md-nav__link">
      New Release Series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/old-release-removal/" title="Old Release Series Removal" class="md-nav__link">
      Old Release Series Removal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/itb-testing/" title="ITB Prerelease Testing" class="md-nav__link">
      ITB Prerelease Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/empty-pkgs/" title="Empty Packages" class="md-nav__link">
      Empty Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../release/acceptance-testing/" title="Acceptance Testing" class="md-nav__link">
      Acceptance Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Policy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Policy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/campus-cyberinfrastructure/" title="Campus Cyberinfrastructure" class="md-nav__link">
      Campus Cyberinfrastructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/cream-support/" title="CREAM-CE Support" class="md-nav__link">
      CREAM-CE Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/service-migrations-spring-2018/" title="Service Migrations - Spring 2018" class="md-nav__link">
      Service Migrations - Spring 2018
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/gums-retire/" title="GUMS Retirement" class="md-nav__link">
      GUMS Retirement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/bestman2-retire/" title="BeStMan2 Retirement" class="md-nav__link">
      BeStMan2 Retirement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/voms-admin-retire/" title="VOMS Admin Retirement" class="md-nav__link">
      VOMS Admin Retirement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/release-series/" title="Release Series Support" class="md-nav__link">
      Release Series Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/globus-toolkit/" title="Globus Toolkit Support" class="md-nav__link">
      Globus Toolkit Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/external-oasis-repos/" title="OASIS Repository Mirroring" class="md-nav__link">
      OASIS Repository Mirroring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/flexible-release-model/" title="Flexible Release Model" class="md-nav__link">
      Flexible Release Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/software-release/" title="Software Release Policy" class="md-nav__link">
      Software Release Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/container-release/" title="Container Release Policy" class="md-nav__link">
      Container Release Policy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../policy/community-testing/" title="Community Testing" class="md-nav__link">
      Community Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/writing-documentation/" title="Writing Documentation" class="md-nav__link">
      Writing Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/reviewing-documentation/" title="Reviewing Documentation" class="md-nav__link">
      Reviewing Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/style-guide/" title="Markdown Style Guide" class="md-nav__link">
      Markdown Style Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/new-doc-area/" title="Creating a New Area" class="md-nav__link">
      Creating a New Area
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Historical Transitions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Historical Transitions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/sha2-support/" title="SHA-2 Support" class="md-nav__link">
      SHA-2 Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../documentation/markdown-migration/" title="Migrating Documents to Markdown" class="md-nav__link">
      Migrating Documents to Markdown
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Meetings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Meetings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191202/" title="December, 2 2019" class="md-nav__link">
      December, 2 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191125/" title="November, 25 2019" class="md-nav__link">
      November, 25 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191118/" title="November, 18 2019" class="md-nav__link">
      November, 18 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191111/" title="November, 11 2019" class="md-nav__link">
      November, 11 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191104/" title="November, 4 2019" class="md-nav__link">
      November, 4 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191028/" title="October, 28 2019" class="md-nav__link">
      October, 28 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191021/" title="October, 21 2019" class="md-nav__link">
      October, 21 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191014/" title="October, 14 2019" class="md-nav__link">
      October, 14 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20191007/" title="October, 7 2019" class="md-nav__link">
      October, 7 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190930/" title="September, 30 2019" class="md-nav__link">
      September, 30 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190923/" title="September, 23 2019" class="md-nav__link">
      September, 23 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190916/" title="September, 16 2019" class="md-nav__link">
      September, 16 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190909/" title="September, 9 2019" class="md-nav__link">
      September, 9 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190826/" title="August, 26 2019" class="md-nav__link">
      August, 26 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190819/" title="August, 19 2019" class="md-nav__link">
      August, 19 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190812/" title="August, 12 2019" class="md-nav__link">
      August, 12 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190805/" title="August, 5 2019" class="md-nav__link">
      August, 5 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190729/" title="July 29, 2019" class="md-nav__link">
      July 29, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190722/" title="July 22, 2019" class="md-nav__link">
      July 22, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190708/" title="July 8, 2019" class="md-nav__link">
      July 8, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190701/" title="July 1, 2019" class="md-nav__link">
      July 1, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190624/" title="June 24, 2019" class="md-nav__link">
      June 24, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190617/" title="June 17, 2019" class="md-nav__link">
      June 17, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190610/" title="June 10, 2019" class="md-nav__link">
      June 10, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190603/" title="June 3, 2019" class="md-nav__link">
      June 3, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190528/" title="May 28, 2019" class="md-nav__link">
      May 28, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190513/" title="May 13, 2019" class="md-nav__link">
      May 13, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190506/" title="May 6, 2019" class="md-nav__link">
      May 6, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190429/" title="April 29, 2019" class="md-nav__link">
      April 29, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190422/" title="April 22, 2019" class="md-nav__link">
      April 22, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190415/" title="April 15, 2019" class="md-nav__link">
      April 15, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190408/" title="April 8, 2019" class="md-nav__link">
      April 8, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190401/" title="April 1, 2019" class="md-nav__link">
      April 1, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190325/" title="March 25, 2019" class="md-nav__link">
      March 25, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190311/" title="March 11, 2019" class="md-nav__link">
      March 11, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190304/" title="March 4, 2019" class="md-nav__link">
      March 4, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190225/" title="February 25, 2019" class="md-nav__link">
      February 25, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190218/" title="February 18, 2019" class="md-nav__link">
      February 18, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190211/" title="February 11, 2019" class="md-nav__link">
      February 11, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190204/" title="February 4, 2019" class="md-nav__link">
      February 4, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190128/" title="January 28, 2019" class="md-nav__link">
      January 28, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190122/" title="January 22, 2019" class="md-nav__link">
      January 22, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190114/" title="January 14, 2019" class="md-nav__link">
      January 14, 2019
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../meetings/2019/TechArea20190107/" title="January 7, 2019" class="md-nav__link">
      January 7, 2019
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#principles" title="Principles" class="md-nav__link">
    Principles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing-packages" title="Contributing Packages" class="md-nav__link">
    Contributing Packages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-infrastructure" title="Development Infrastructure" class="md-nav__link">
    Development Infrastructure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upstream-source-cache" title="Upstream Source Cache" class="md-nav__link">
    Upstream Source Cache
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#locating-files-in-the-cache" title="Locating Files in the Cache" class="md-nav__link">
    Locating Files in the Cache
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributing-upstream-files" title="Contributing Upstream Files" class="md-nav__link">
    Contributing Upstream Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gitgithub-hosted-upstream-files" title="Git/GitHub Hosted Upstream Files" class="md-nav__link">
    Git/GitHub Hosted Upstream Files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#revision-control-system" title="Revision Control System" class="md-nav__link">
    Revision Control System
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#subversion-access" title="Subversion Access" class="md-nav__link">
    Subversion Access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#osg-owned-software" title="OSG-Owned Software" class="md-nav__link">
    OSG-Owned Software
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging-top-level-directory-organization" title="Packaging Top-Level Directory Organization" class="md-nav__link">
    Packaging Top-Level Directory Organization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#package-directory-organization" title="Package Directory Organization" class="md-nav__link">
    Package Directory Organization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#readme" title="README" class="md-nav__link">
    README
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upstream" title="upstream" class="md-nav__link">
    upstream
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cached-files" title="Cached files" class="md-nav__link">
    Cached files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-repos" title="GitHub repos" class="md-nav__link">
    GitHub repos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#git-repos" title="Git repos" class="md-nav__link">
    Git repos
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typical-workflow-when-building-out-of-github-repos" title="Typical workflow when building out of GitHub repos" class="md-nav__link">
    Typical workflow when building out of GitHub repos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-features-for-git-and-github-repos" title="Advanced features for Git and GitHub repos" class="md-nav__link">
    Advanced features for Git and GitHub repos
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#osg" title="osg" class="md-nav__link">
    osg
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generated-directories" title="Generated directories" class="md-nav__link">
    Generated directories
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#95upstream95srpm95contents" title="_upstream_srpm_contents" class="md-nav__link">
    _upstream_srpm_contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95upstream95tarball95contents" title="_upstream_tarball_contents" class="md-nav__link">
    _upstream_tarball_contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95final95srpm95contents" title="_final_srpm_contents" class="md-nav__link">
    _final_srpm_contents
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95build95results" title="_build_results" class="md-nav__link">
    _build_results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95quilt" title="_quilt" class="md-nav__link">
    _quilt
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packaging-organization-examples" title="Packaging Organization Examples" class="md-nav__link">
    Packaging Organization Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-case-1-packaging-an-upstream-source-tarball" title="Use Case 1: Packaging an Upstream Source Tarball" class="md-nav__link">
    Use Case 1: Packaging an Upstream Source Tarball
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case-2-passing-through-a-source-rpm" title="Use Case 2: Passing Through a Source RPM" class="md-nav__link">
    Use Case 2: Passing Through a Source RPM
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-case-3-modifying-a-source-rpm" title="Use Case 3: Modifying a Source RPM" class="md-nav__link">
    Use Case 3: Modifying a Source RPM
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-process" title="Build Process" class="md-nav__link">
    Build Process
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#osg-software-repository" title="OSG Software Repository" class="md-nav__link">
    OSG Software Repository
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#release-levels" title="Release Levels" class="md-nav__link">
    Release Levels
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-conventions" title="Packaging Conventions" class="md-nav__link">
    Packaging Conventions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-for-multiple-distro-versions" title="Packaging for Multiple Distro Versions" class="md-nav__link">
    Packaging for Multiple Distro Versions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#conditionalizing-spec-files" title="Conditionalizing spec files" class="md-nav__link">
    Conditionalizing spec files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#renaming-or-removing-packages" title="Renaming or Removing Packages" class="md-nav__link">
    Renaming or Removing Packages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dummying-out-a-package" title="Dummying out a package" class="md-nav__link">
    Dummying out a package
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/opensciencegrid/technology/edit/master/docs/software/rpm-development-guide.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="rpm-development-guide">RPM Development Guide<a class="headerlink" href="#rpm-development-guide" title="Permanent link">&para;</a></h1>
<p>This page documents technical guidelines and details about RPM development for the OSG Software Stack. The procedures, conventions, and policies defined within are used by the OSG Software Team, and are recommended to all external developers who wish to contribute to the OSG Software Stack.</p>
<h2 id="principles">Principles<a class="headerlink" href="#principles" title="Permanent link">&para;</a></h2>
<p>The principles below guide the design and implementation of the technical details that follow.</p>
<ul>
<li>Packages should adhere to community standards (e.g., <a href="http://fedoraproject.org/wiki/PackagingGuidelines">Fedora Packaging Guidelines</a>) when possible, and significant deviations must be documented</li>
<li>Every released package must be reproducible from data stored in our system</li>
<li>Source code for software should be clearly separable from the packaging of that software</li>
<li>Upstream source files (which should not be modified) should be clearly separated from files owned by the OSG Software Team</li>
<li>Building source and binary packages from our system should be easy and efficient</li>
<li>External developers should have a clear and effective system for developing and contributing packages</li>
<li>We should use standard tools from relevant packaging and development communities when appropriate</li>
</ul>
<h2 id="contributing-packages">Contributing Packages<a class="headerlink" href="#contributing-packages" title="Permanent link">&para;</a></h2>
<p>We encourage all interested parties to contribute to OSG Software, and all the infrastructure described on this page should be friendly to external contributors.</p>
<ul>
<li>To participate in the packaging community: You must subscribe to the <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#111;&#115;&#103;&#45;&#115;&#111;&#102;&#116;&#119;&#97;&#114;&#101;&#64;&#111;&#112;&#101;&#110;&#115;&#99;&#105;&#101;&#110;&#99;&#101;&#103;&#114;&#105;&#100;&#46;&#111;&#114;&#103;">&#111;&#115;&#103;&#45;&#115;&#111;&#102;&#116;&#119;&#97;&#114;&#101;&#64;&#111;&#112;&#101;&#110;&#115;&#99;&#105;&#101;&#110;&#99;&#101;&#103;&#114;&#105;&#100;&#46;&#111;&#114;&#103;</a> email list. Subscribing to an OSG email list is <a href="https://listserv.fnal.gov/users.asp#subscribe%20to%20list">described here</a>.</li>
<li>To create and edit packages: <a href="http://vdt.cs.wisc.edu/internal/svn.html">Obtain access to VDT SVN</a>.</li>
<li>To upload new source tarballs: You must have a cs.wisc.edu account with write access to the VDT source tarball directory. Email the osg-software list and request permission.</li>
<li>To build using the OSG's Koji build system: You must have a valid grid certificate and a Koji account. Email the osg-software list with your cert's DN and request permission.</li>
</ul>
<h2 id="development-infrastructure">Development Infrastructure<a class="headerlink" href="#development-infrastructure" title="Permanent link">&para;</a></h2>
<p>This section documents most of what a developer needs to know about our RPM infrastructure:</p>
<ul>
<li>Upstream Source Cache — a filesystem scheme for caching upstream source files</li>
<li>Revision Control System — where to get and store development files, and how they are organized</li>
<li>Build System — how to build packages from the revision control system</li>
<li>Yum Repository — the location and organization of our Yum repository, and how to promote packages through it</li>
</ul>
<h3 id="upstream-source-cache">Upstream Source Cache<a class="headerlink" href="#upstream-source-cache" title="Permanent link">&para;</a></h3>
<p>One of our principles (every released package must be reproducible from data stored in our system) creates a potential issue: If we keep all historical source data, especially upstream files like source tarballs and source RPMs, in our revision control system, we may face large checkouts and consequently long checkout and update times.</p>
<p>Our solution is to cache all upstream source files in a separate filesystem area, retaining historical files indefinitely. To avoid tainting upstream files, our policy is to leave them unmodified after download.</p>
<h4 id="locating-files-in-the-cache">Locating Files in the Cache<a class="headerlink" href="#locating-files-in-the-cache" title="Permanent link">&para;</a></h4>
<p>Upstream source files are stored in the filesystem as follows:</p>
<blockquote>
<p><code>/p/vdt/public/html/upstream/&lt;PACKAGE&gt;/&lt;VERSION&gt;/&lt;FILE&gt;</code></p>
</blockquote>
<p>where:</p>
<table>
<thead>
<tr>
<th align="left">Symbol</th>
<th align="left">Definition</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>&lt;PACKAGE&gt;</code></td>
<td align="left">Upstream name of the source package, or some widely accepted form thereof</td>
<td align="left"><code>ndt</code></td>
</tr>
<tr>
<td align="left"><code>&lt;VERSION&gt;</code></td>
<td align="left">Upstream version string used to identify the release</td>
<td align="left"><code>3.6.4</code></td>
</tr>
<tr>
<td align="left"><code>&lt;FILE&gt;</code></td>
<td align="left">Upstream filename itself</td>
<td align="left"><code>ndt-3.6.4.tar.gz</code></td>
</tr>
</tbody>
</table>
<p>The authoritative cache is the VDT webserver, which is fully backed up. The Koji build system uses this cache.</p>
<p>Upstream source files are referenced from within the revision control system; see below for details.</p>
<p>You will need to know the SHA1 checksum of any files you use from the cache.  Do get it, do:</p>
<div class="codehilite"><pre><span></span><span class="gp">$</span> sha1sum /p/vdt/public/html/upstream/&lt;PACKAGE&gt;/&lt;VERSION&gt;/&lt;FILE&gt;
</pre></div>


<h4 id="contributing-upstream-files">Contributing Upstream Files<a class="headerlink" href="#contributing-upstream-files" title="Permanent link">&para;</a></h4>
<p>You must make sure that any new upstream source files are cached on the VDT webserver before building the package via Koji. You have two options:</p>
<ul>
<li>If you have access to a UW–Madison CSL machine, you can scp the source files directly into the AFS locations using that machine</li>
<li>If you do not have such access, write to the osg-software list to find someone who will post the files for you</li>
</ul>
<h4 id="gitgithub-hosted-upstream-files">Git/GitHub Hosted Upstream Files<a class="headerlink" href="#gitgithub-hosted-upstream-files" title="Permanent link">&para;</a></h4>
<p>It is also possible to pull sources and spec files from remote Git or GitHub repos instead of our source cache.
See the <a href="#upstream">upstream dir info</a> for more information.</p>
<h3 id="revision-control-system">Revision Control System<a class="headerlink" href="#revision-control-system" title="Permanent link">&para;</a></h3>
<p>All packages that the OSG Software Team releases are checked into our Subversion repository.</p>
<h4 id="subversion-access">Subversion Access<a class="headerlink" href="#subversion-access" title="Permanent link">&para;</a></h4>
<p>Our Subversion repository is located at:</p>
<blockquote>
<div class="codehilite"><pre><span></span>https://vdt.cs.wisc.edu/svn
</pre></div>


</blockquote>
<p><a href="http://vdt.cs.wisc.edu/internal/svn.html">Procedure for offsite users obtaining access to Subversion</a></p>
<p>Or, from a UW–Madison Computer Sciences machine:</p>
<blockquote>
<div class="codehilite"><pre><span></span>file:///p/condor/workspaces/vdt/svn
</pre></div>


</blockquote>
<p>The current SVN directory housing our native package work is <code>$SVN/native/redhat</code> (where <code>$SVN</code> is one of the ways of accessing our SVN repository above). For example, to check out the current package repository via HTTPS, do:</p>
<div class="codehilite"><pre><span></span><span class="gp">[you@host]$</span> svn co https://vdt.cs.wisc.edu/svn/native/redhat
</pre></div>


<h4 id="osg-owned-software">OSG-Owned Software<a class="headerlink" href="#osg-owned-software" title="Permanent link">&para;</a></h4>
<p>OSG-owned software goes into GitHub under the <code>opensciencegrid</code> organization. Files are organized as the developer sees fit.</p>
<p>It is strongly recommended that each software package include a top-level Makefile with at least the following targets:</p>
<table>
<thead>
<tr>
<th align="left">Symbol</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>install</code></td>
<td align="left">Install the software into final FHS locations rooted at <code>DESTDIR</code></td>
</tr>
<tr>
<td align="left"><code>dist</code></td>
<td align="left">Create a distribution source tarball (in the current section directory) for a release</td>
</tr>
<tr>
<td align="left"><code>upstream</code></td>
<td align="left">Install the distribution source tarball into the upstream source cache</td>
</tr>
</tbody>
</table>
<h4 id="packaging-top-level-directory-organization">Packaging Top-Level Directory Organization<a class="headerlink" href="#packaging-top-level-directory-organization" title="Permanent link">&para;</a></h4>
<p>The top levels of our Subversion directory hierarchy for packaging are as follows:</p>
<blockquote>
<p><code>native/redhat/&lt;SECTION&gt;/&lt;PACKAGE&gt;</code></p>
</blockquote>
<p>where:</p>
<table>
<thead>
<tr>
<th align="left">Symbol</th>
<th align="left">Definition</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>&lt;SECTION&gt;</code></td>
<td align="left">Development section</td>
<td align="left">Standard Subversion sections like <code>trunk</code> and <code>branches/*</code></td>
</tr>
<tr>
<td align="left"><code>&lt;PACKAGE&gt;</code></td>
<td align="left">Our standardized name for a source package</td>
<td align="left"><code>ndt</code></td>
</tr>
</tbody>
</table>
<h4 id="package-directory-organization">Package Directory Organization<a class="headerlink" href="#package-directory-organization" title="Permanent link">&para;</a></h4>
<p>Within a source package directory, the following files (detailed in separate sections below) may exist:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>README</code></td>
<td>text file</td>
<td>package notes, by and for developers</td>
</tr>
<tr>
<td><code>upstream/</code></td>
<td>directory</td>
<td>references to the upstream source cache and other kinds of upstream files</td>
</tr>
<tr>
<td><code>osg/</code></td>
<td>directory</td>
<td>overrides and patches of upstream files, plus new files, which contribute to the final OSG source package</td>
</tr>
</tbody>
</table>
<h5 id="readme">README<a class="headerlink" href="#readme" title="Permanent link">&para;</a></h5>
<p>This is a free-form text file for developers to leave notes about the package. Please document anything interesting about how you procured the upstream source, the reasons for the modifications you made, or anything else people might need to know in order to maintain the package in the future. Please document the <em>why</em>, not just the <em>what</em>.</p>
<h5 id="upstream">upstream<a class="headerlink" href="#upstream" title="Permanent link">&para;</a></h5>
<p>Within the per-package directories of the revision control system, there must be a way to refer to cached files. This is done with small text files that (a) are named consistently, and (b) contain the location of the referenced file as its contents.</p>
<p>A reference file is named:</p>
<blockquote>
<p><code>&lt;DESCRIPTION&gt;.&lt;TYPE&gt;.source</code></p>
</blockquote>
<p>where:</p>
<table>
<thead>
<tr>
<th align="left">Symbol</th>
<th align="left">Definition</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>&lt;DESCRIPTION&gt;</code></td>
<td align="left">Descriptive label of the source of the referenced file</td>
<td align="left"><code>developer</code>, <code>epel</code>, <code>emi</code></td>
</tr>
<tr>
<td align="left"><code>&lt;TYPE&gt;</code></td>
<td align="left">Type of referenced file</td>
<td align="left"><code>tarball</code>, <code>srpm</code></td>
</tr>
</tbody>
</table>
<p>and contain references to cached files, Git repos, and comments.
which start with <code>#</code> and continue until the end of the line.
It is useful to add the source of the upstream file into a comment.</p>
<h6 id="cached-files">Cached files<a class="headerlink" href="#cached-files" title="Permanent link">&para;</a></h6>
<p>To reference files in the upstream source cache, use the upstream source cache path defined above,
without the prefix component, followed by the sha1sum of the file:</p>
<blockquote>
<p><code>&lt;PACKAGE&gt;/&lt;VERSION&gt;/&lt;FILE&gt; sha1sum=&lt;SHA1SUM&gt;</code></p>
</blockquote>
<p>Obtain the sha1sum by running the <code>sha1sum</code> command with the source file as an argument, i.e.</p>
<div class="codehilite"><pre><span></span><span class="gp">$</span> sha1sum /p/vdt/public/html/upstream/&lt;PACKAGE&gt;/&lt;VERSION&gt;/&lt;FILE&gt;
</pre></div>


<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature requires OSG-Build 1.14.0 or later.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The reference file for <code>globus-common</code>'s source tarball is named <code>epel.srpm.source</code> and contains:</p>
<div class="codehilite"><pre><span></span>globus-common/16.4/globus-common-16.4-1.el6.src.rpm sha1sum=134478c56c2437c335c20636831f794b66290bec
# Downloaded from &#39;http://dl.fedoraproject.org/pub/epel/6/SRPMS/globus-common-16.4-1.el6.src.rpm&#39;
</pre></div>


</div>
<h6 id="github-repos">GitHub repos<a class="headerlink" href="#github-repos" title="Permanent link">&para;</a></h6>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>OSG software policy requires that all Git and GitHub repos used for building software have mirrors at the UW.
Many software repos under the <a href="https://github.com/opensciencegrid">opensciencegrid GitHub organization</a> are already mirrored.
If you are uncertain, or have a new project that you want mirrored, send email to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#111;&#115;&#103;&#45;&#115;&#111;&#102;&#116;&#119;&#97;&#114;&#101;&#64;&#111;&#112;&#101;&#110;&#115;&#99;&#105;&#101;&#110;&#99;&#101;&#103;&#114;&#105;&#100;&#46;&#111;&#114;&#103;">&#111;&#115;&#103;&#45;&#115;&#111;&#102;&#116;&#119;&#97;&#114;&#101;&#64;&#111;&#112;&#101;&#110;&#115;&#99;&#105;&#101;&#110;&#99;&#101;&#103;&#114;&#105;&#100;&#46;&#111;&#114;&#103;</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See also <a href="#advanced-features-for-git-and-github-repos">advanced features for Git and GitHub repos</a>.</p>
</div>
<p>To reference tags in GitHub repos, use the following syntax (all on one line):</p>
<blockquote>
<p><code>type=github repo=&lt;OWNER&gt;/&lt;PROJECT&gt; tag=&lt;TAG&gt; hash=&lt;HASH&gt;</code></p>
</blockquote>
<p>where:</p>
<table>
<thead>
<tr>
<th align="left">Symbol</th>
<th align="left">Definition</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>&lt;OWNER&gt;</code></td>
<td align="left">Owner of the GitHub repo</td>
<td align="left"><code>opensciencegrid</code></td>
</tr>
<tr>
<td align="left"><code>&lt;PROJECT&gt;</code></td>
<td align="left">Name of the project</td>
<td align="left"><code>osg-build</code></td>
</tr>
<tr>
<td align="left"><code>&lt;TAG&gt;</code></td>
<td align="left">Git tag to use</td>
<td align="left"><code>v1.12.2</code></td>
</tr>
<tr>
<td align="left"><code>&lt;HASH&gt;</code></td>
<td align="left">Full 40-char Git hash of the tag</td>
<td align="left"><code>cff50ffe812282552cedae81f3809d3cf7087a3e</code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The tarball will be called <code>&lt;PROJECT&gt;-&lt;VERSION&gt;.tar.gz</code> where <code>&lt;VERSION&gt;</code> is <code>&lt;TAG&gt;</code> without the <code>v</code> prefix (if there is one).</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>You can refer to the 1.12.2 release of osg-build with this line:</p>
<div class="codehilite"><pre><span></span>type=github repo=opensciencegrid/osg-build tag=v1.12.2 hash=cff50ffe812282552cedae81f3809d3cf7087a3e
</pre></div>


<p>This results in a tarball named <code>osg-build-1.12.2.tar.gz</code>.</p>
</div>
<p>In addition, if the repository contains a file called <code>rpm/&lt;PROJECT&gt;.spec</code>, it will be used as the spec file for the build
(unless overridden in the <code>osg</code> directory).</p>
<h6 id="git-repos">Git repos<a class="headerlink" href="#git-repos" title="Permanent link">&para;</a></h6>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>OSG software policy requires that all Git and GitHub repos used for building software have mirrors at the UW.
Many software repos under the <a href="https://github.com/opensciencegrid">opensciencegrid GitHub organization</a> are already mirrored.
If you are uncertain, or have a new project that you want mirrored, send email to <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#111;&#115;&#103;&#45;&#115;&#111;&#102;&#116;&#119;&#97;&#114;&#101;&#64;&#111;&#112;&#101;&#110;&#115;&#99;&#105;&#101;&#110;&#99;&#101;&#103;&#114;&#105;&#100;&#46;&#111;&#114;&#103;">&#111;&#115;&#103;&#45;&#115;&#111;&#102;&#116;&#119;&#97;&#114;&#101;&#64;&#111;&#112;&#101;&#110;&#115;&#99;&#105;&#101;&#110;&#99;&#101;&#103;&#114;&#105;&#100;&#46;&#111;&#114;&#103;</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can use a shorter syntax for GitHub repos -- see above.</p>
<p>See also <a href="#advanced-features-for-git-and-github-repos">advanced features for Git and GitHub repos</a>.</p>
</div>
<p>To reference tags in Git repos, use the following syntax (all on one line):</p>
<blockquote>
<p><code>type=git url=&lt;URL&gt; name=&lt;NAME&gt; tag=&lt;TAG&gt; hash=&lt;HASH&gt;</code></p>
</blockquote>
<p>where:</p>
<table>
<thead>
<tr>
<th align="left">Symbol</th>
<th align="left">Definition</th>
<th align="left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>&lt;URL&gt;</code></td>
<td align="left">Location of the Git repo</td>
<td align="left"><code>https://github.com/opensciencegrid/osg-build.git</code></td>
</tr>
<tr>
<td align="left"><code>&lt;NAME&gt;</code></td>
<td align="left">Name of the software (optional)</td>
<td align="left"><code>osg-build</code></td>
</tr>
<tr>
<td align="left"><code>&lt;TAG&gt;</code></td>
<td align="left">Git tag to use</td>
<td align="left"><code>v1.11.2</code></td>
</tr>
<tr>
<td align="left"><code>&lt;HASH&gt;</code></td>
<td align="left">Full 40-char Git hash of the tag</td>
<td align="left"><code>5bcf48c442d21b1e8c93a468d884f84122f7cc9e</code></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>&lt;NAME&gt;</code> is optional; if not present, OSG-Build will use the last component of the URL, without the <code>.git</code> suffix.</p>
<p>The tarball will be called <code>&lt;NAME&gt;-&lt;VERSION&gt;.tar.gz</code> where <code>&lt;VERSION&gt;</code> is <code>&lt;TAG&gt;</code> without the <code>v</code> prefix (if there is one).</p>
</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The reference file for <code>osg-build</code>'s repo is named <code>osg.github.source</code> and contains:</p>
<div class="codehilite"><pre><span></span>type=git url=https://github.com/opensciencegrid/osg-build.git name=osg-build tag=v1.11.2 hash=5bcf48c442d21b1e8c93a468d884f84122f7cc9e
</pre></div>


<p>This results in a tarball named <code>osg-build-1.11.2.tar.gz</code>.</p>
</div>
<p>In addition, if the repository contains a file called <code>rpm/&lt;NAME&gt;.spec</code>, it will be used as the spec file for the build
(unless overridden in the <code>osg</code> directory).</p>
<h5 id="typical-workflow-when-building-out-of-github-repos">Typical workflow when building out of GitHub repos<a class="headerlink" href="#typical-workflow-when-building-out-of-github-repos" title="Permanent link">&para;</a></h5>
<ol>
<li>Fork the repository of the package that you would like to build</li>
<li>Create a new branch in your fork</li>
<li>Make, commit, and push changes to your new branch</li>
<li>In your fork, tag the commit that you would like to build</li>
<li>In the <code>upstream/osg.github.source</code>, change the repo to point at your fork and tag</li>
<li>Attempt a scratch build</li>
<li>If the build fails, remove the tag and repeat steps 3-6</li>
<li>Submit a PR to merge changes upstream</li>
<li>Tag the final version on the upstream fork</li>
<li>Build the version that will go through the normal software cycle</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Packaging-only changes should be tagged with a release number of the format <code>v&lt;version&gt;-&lt;release&gt;</code>, e.g. <code>v3.4.23-2</code></p>
</div>
<h5 id="advanced-features-for-git-and-github-repos">Advanced features for Git and GitHub repos<a class="headerlink" href="#advanced-features-for-git-and-github-repos" title="Permanent link">&para;</a></h5>
<p>The following features make software development in Git and GitHub more convenient:</p>
<ul>
<li>
<p>Support for RPM release numbers in Git tags:</p>
<p>If the tag for the software contains a dash, as in <code>v1.12.2-1</code>,
it is assumed that the text after the dash is the RPM release instead of the software version.
The RPM release is not included in the tarball.
That is, the project <code>osg-build</code> with the tag <code>v1.12.2-1</code> will result in a tarball named <code>osg-build-1.12.1.tar.gz</code>,
not <code>osg-build-1.12.1-1.tar.gz</code>.</p>
</li>
<li>
<p>Can specify tarball name in the .source file:</p>
<p>The new <code>tarball</code> attribute allows you to specify the name of the tarball and directory that the repo contents will be put into.
The syntax is <code>tarball=&lt;NAME&gt;.tar.gz</code>.
The extension must be <code>.tar.gz</code>, no other archive formats are supported.
The directory inside the tarball will then be <code>&lt;NAME&gt;/</code>.</p>
</li>
<li>
<p>Can ignore hash mismatch (scratch and local builds only):</p>
<p>For local builds (rpmbuild and mock tasks) and Koji scratch builds, a hash mismatch will result in a warning.
Non-scratch Koji builds will still consider it an error.</p>
</li>
<li>
<p>Can use a branch as the tag:</p>
<p>The <code>tag</code> attribute can refer to a branch instead of a tag, e.g. <code>tag=master</code>.</p>
</li>
</ul>
<p>Combining the last two features can really speed up package development.
For example, you can use this to make scratch builds of the current master:</p>
<div class="codehilite"><pre><span></span>type=github repo=&lt;OWNER&gt;/&lt;PROJECT&gt; tarball=&lt;PROJECT&gt;-&lt;VERSION&gt;.tar.gz tag=master hash=0
</pre></div>


<p>This might also be useful as part of a continuous integration scheme (e.g. Travis-CI).</p>
<h5 id="osg">osg<a class="headerlink" href="#osg" title="Permanent link">&para;</a></h5>
<p>The <code>osg</code> directory contains files that are owned by the OSG Software Team and that are used to create the final, released source package. It may contain a variety of development files:</p>
<ul>
<li>An RPM <code>.spec</code> file, which overrides any spec file from a referenced source</li>
<li>Patch (<code>.patch</code>) or replacement files, which override any same-named file from the top-level directory of a referenced source</li>
<li>Other files, which must be explicitly placed into the package by the spec file</li>
</ul>
<h4 id="generated-directories">Generated directories<a class="headerlink" href="#generated-directories" title="Permanent link">&para;</a></h4>
<p>The following directories may be generated by our build tool, <a href="../../software/osg-build-tools">OSG-Build</a>. They are not under revision control.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>_upstream_srpm_contents/</code></td>
<td>expanded contents of a cached upstream source package</td>
</tr>
<tr>
<td><code>_upstream_tarball_contents/</code></td>
<td>expanded contents of all cached upstream source tarballs</td>
</tr>
<tr>
<td><code>_final_srpm_contents/</code></td>
<td>the final contents of the OSG source package</td>
</tr>
<tr>
<td><code>_build_results/</code></td>
<td>OSG source and binary packages resulting from a build</td>
</tr>
<tr>
<td><code>_quilt/</code></td>
<td>expanded, patched contents of the upstream sources, as generated by the <code>quilt</code> tool</td>
</tr>
</tbody>
</table>
<h5 id="95upstream95srpm95contents">_upstream_srpm_contents<a class="headerlink" href="#95upstream95srpm95contents" title="Permanent link">&para;</a></h5>
<p>The <code>_upstream_srpm_contents</code> directory contains the files that are part of the upstream source package. It is a volatile record of the upstream source for developer use.</p>
<h5 id="95upstream95tarball95contents">_upstream_tarball_contents<a class="headerlink" href="#95upstream95tarball95contents" title="Permanent link">&para;</a></h5>
<p>The <code>_upstream_tarball_contents</code> directory contains the files that are part of the upstream source tarballs. It is generated by the package build tool if the <code>--full-extract</code> option is passed. It is not used for anything by the build tool, but meant as a convenience to allow the developer to look inside the upstream sources (for making patches, etc.).</p>
<h5 id="95final95srpm95contents">_final_srpm_contents<a class="headerlink" href="#95final95srpm95contents" title="Permanent link">&para;</a></h5>
<p>The <code>_final_srpm_contents</code> directory contains the final files that are part of the released source package. It is a volatile record of a build for developer use.</p>
<h5 id="95build95results">_build_results<a class="headerlink" href="#95build95results" title="Permanent link">&para;</a></h5>
<p>The <code>_build_results</code> directory contains the source and binary RPMs that are produced by a local build. It is a volatile record of a build for developer use.</p>
<h5 id="95quilt">_quilt<a class="headerlink" href="#95quilt" title="Permanent link">&para;</a></h5>
<p>The <code>_quilt</code> directory contains the unpacked sources after they have been patched using the <a href="http://savannah.nongnu.org/projects/quilt">quilt</a> utility. This allows easier patch development.</p>
<h4 id="packaging-organization-examples">Packaging Organization Examples<a class="headerlink" href="#packaging-organization-examples" title="Permanent link">&para;</a></h4>
<h5 id="use-case-1-packaging-an-upstream-source-tarball">Use Case 1: Packaging an Upstream Source Tarball<a class="headerlink" href="#use-case-1-packaging-an-upstream-source-tarball" title="Permanent link">&para;</a></h5>
<p>When the OSG Software Team packages an upstream source tarball, for which there is no existing package, the source tarball is referenced with a .source file and we provide a spec file and, if necessary, patches. For example, RSV is provided as a source tarball only. Its package directory contains:</p>
<blockquote>
<div class="codehilite"><pre><span></span>rsv/
    osg/
        rsv.spec
    upstream/
        developer.tarball.source
</pre></div>


</blockquote>
<h5 id="use-case-2-passing-through-a-source-rpm">Use Case 2: Passing Through a Source RPM<a class="headerlink" href="#use-case-2-passing-through-a-source-rpm" title="Permanent link">&para;</a></h5>
<p>When the OSG Software Team simply provides a copy of an existing source RPM, it is referenced with a .source file and that is it. For example, we do not modify the <code>globus-common</code> source RPM from EPEL. Its package directory contains:</p>
<blockquote>
<div class="codehilite"><pre><span></span>globus-common/
    upstream/
        epel.srpm.source
</pre></div>


</blockquote>
<h5 id="use-case-3-modifying-a-source-rpm">Use Case 3: Modifying a Source RPM<a class="headerlink" href="#use-case-3-modifying-a-source-rpm" title="Permanent link">&para;</a></h5>
<p>When the OSG Software Team modifies an existing source RPM, it is referenced with a .source file and then all changes to the upstream source are contained in the <code>osg</code> directory. For example, we use this mechanism for the <code>globus-ftp-client</code> package, originally obtained from EPEL. Its package directory contains:</p>
<blockquote>
<div class="codehilite"><pre><span></span>globus-ftp-client/
    osg/
        globus-ftp-client.spec
        1853-ssh-bin.patch
    upstream/
        epel.srpm.source
</pre></div>


</blockquote>
<h3 id="build-process">Build Process<a class="headerlink" href="#build-process" title="Permanent link">&para;</a></h3>
<ol>
<li>All necessary information to create the package will be committed to the VDT source code repository (see below)</li>
<li>The <a href="../../software/osg-build-tools">OSG build tools</a> will take those files, create a source RPM, and submit it to our Koji build system</li>
</ol>
<p>Developers may use <code>rpmbuild</code> and <code>mock</code> for faster iterative development before submitting the package to Koji. <code>osg-build</code> may be used as a wrapper script around <code>rpmbuild</code> and <code>mock</code>.</p>
<h3 id="osg-software-repository">OSG Software Repository<a class="headerlink" href="#osg-software-repository" title="Permanent link">&para;</a></h3>
<p>OSG Operations maintains the Yum repositories that contain our source and binary RPMs at <code>https://repo.opensciencegrid.org/osg/</code> and are mirrored at other institutions as well.</p>
<h4 id="release-levels">Release Levels<a class="headerlink" href="#release-levels" title="Permanent link">&para;</a></h4>
<p>Every package is classified into a release level based on the amount of testing it has undergone and our confidence in
its stability.
When a package is first built, it goes into the lowest level (<code>osg-development</code>).
The members of the OSG Software and Release teams may promote packages through the release levels, as per our
<a href="../../policy/software-release">Release Policy page</a>.</p>
<h2 id="packaging-conventions">Packaging Conventions<a class="headerlink" href="#packaging-conventions" title="Permanent link">&para;</a></h2>
<p>In addition to adhering to the <a href="http://fedoraproject.org/wiki/PackagingGuidelines">Fedora Packaging Guidelines</a> (FPG), we have a few rules and guidelines of our own:</p>
<ul>
<li>When we pass-through an RPM and make any changes to it (so it has an updated package number), we construct the version-release as follows:<ul>
<li>The version of the original RPM remains unchanged</li>
<li>The release is composed of three parts: ORIGINALRELEASE.OSGRELEASE</li>
<li>We add a distro tag based on the OSG major version and OS major version, e.g. "osg33.el6". (Use <code>%{?dist}</code> in the Release field)</li>
</ul>
</li>
</ul>
<p>Example: We copy package foobar-3.0.5-1 from somewhere. We need to patch it, so the full name-version-release (NVR) for OSG 3.3 on EL 6 becomes <code>foobar-3.0.5-1.1.osg33.el6</code> Note that we added ".1.osg33.el6" to the release number. If we update our packaging (but still base on foobar-3.0.5-1), we change to ".2.osg33.el6". In the spec file, this would look like:</p>
<div class="codehilite"><pre><span></span><span class="gh">Release</span><span class="p">:</span> 1.2<span class="nv">%{?dist}</span>
</pre></div>


<h2 id="packaging-for-multiple-distro-versions">Packaging for Multiple Distro Versions<a class="headerlink" href="#packaging-for-multiple-distro-versions" title="Permanent link">&para;</a></h2>
<h3 id="conditionalizing-spec-files">Conditionalizing spec files<a class="headerlink" href="#conditionalizing-spec-files" title="Permanent link">&para;</a></h3>
<p>Some packages may need different build behavior between major versions of the OS; RPM conditional statements will be used to handle this.</p>
<p>The following macros are defined:</p>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Value (EL6)</th>
<th align="left">Value (EL7)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>%rhel</code></td>
<td align="left"><code>6</code></td>
<td align="left"><code>7</code></td>
</tr>
<tr>
<td align="left"><code>%el6</code></td>
<td align="left"><code>1</code></td>
<td align="left"><em>undefined</em> or <code>0</code></td>
</tr>
<tr>
<td align="left"><code>%el7</code></td>
<td align="left"><em>undefined</em> or <code>0</code></td>
<td align="left"><code>1</code></td>
</tr>
</tbody>
</table>
<p>Here's how to use them:</p>
<div class="codehilite"><pre><span></span><span class="cp">%if</span> 0%{?el6}
<span class="c"># this code will be executed on EL 6 only</span>
<span class="cp">%endif</span>

<span class="cp">%if</span> 0%{?el7}
<span class="c"># this code will be executed on EL 7 only</span>
<span class="cp">%endif</span>

<span class="cp">%if</span> 0%{?rhel} &gt;= 7
<span class="c"># this code will be executed on EL 7 and newer</span>
<span class="cp">%endif</span>
</pre></div>


<p>(There does not seem to be an <code>%elseif</code>).</p>
<p>The syntax <code>%{?el6}</code> expands to the value of the <code>%el6</code> macro if it is defined, and to the empty string if not; the <code>0</code> is there to keep the condition from being empty in the <code>%if</code> statement if the macro is not defined.</p>
<h2 id="renaming-or-removing-packages">Renaming or Removing Packages<a class="headerlink" href="#renaming-or-removing-packages" title="Permanent link">&para;</a></h2>
<p>Occasionally we want to cause a package to be removed on update, or replaced by a package with a different name.</p>
<p>For the most part, the <a href="https://fedoraproject.org/wiki/Packaging:Guidelines#Renaming.2FReplacing_Existing_Packages">Fedora Packaging Guidelines page on renames</a> shows how to do that.
The exception is that we do not have the equivalent of a <code>fedora-obsolete-packages</code> package, so in order to force the removal of an entire package (not a subpackage), we have to dummy out the package instead -- see below.
(This should be a rare situation.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After doing a rename or a removal, you must update all the packages and subpackages that require the package being removed or renamed, and change or remove the requirements as appropriate.</p>
</div>
<p>To find packages that require the old package at run time, set up a host with the OSG repos and install the <code>yum-utils</code> RPM.
Then, run:</p>
<div class="codehilite"><pre><span></span><span class="gp">$</span> repoquery --plugins --whatrequires <span class="nv">$OLDPACKAGE</span>
</pre></div>


<p>To find packages that require the old package at build time, install <code>osg-build</code>, and do this from a checkout of the OSG repos:</p>
<div class="codehilite"><pre><span></span><span class="gp">$</span> osg-build prebuild *
<span class="gp">$</span> <span class="k">for</span> srpm in */_final_srpm_contents/*.src.rpm<span class="p">;</span> <span class="k">do</span> <span class="se">\</span>
    <span class="nb">echo</span> <span class="s2">&quot;***** </span><span class="nv">$srpm</span><span class="s2"> *****&quot;</span><span class="p">;</span> <span class="se">\</span>
    rpm -q --requires -p <span class="nv">$srpm</span> <span class="p">|</span> grep -w <span class="nv">$OLDPACKAGE</span><span class="p">;</span> <span class="se">\</span>
  <span class="k">done</span>
</pre></div>


<p>(examine the output to avoid false matches)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Carefully test these changes, including places where the old package may be brought in indirectly.</p>
</div>
<h3 id="dummying-out-a-package">Dummying out a package<a class="headerlink" href="#dummying-out-a-package" title="Permanent link">&para;</a></h3>
<p>In order to forcibly remove an entire package with no replacement, you have to replace the package with one that does nothing.
This is because there is no package that will "obsolete" the old package.</p>
<p>Do the following for the main package and any subpackages it may have:</p>
<ul>
<li>Change the Summary to "Dummy package"</li>
<li>
<p>Change the %description to:</p>
<blockquote>
<p>This is an empty package created for $REASONS
It may safely be removed.</p>
</blockquote>
<p>Where <code>$REASONS</code> is a description of why you need this dummy package</p>
</li>
<li>
<p>Remove all Requires and Obsoletes lines</p>
</li>
<li>Do not remove Provides lines</li>
<li>Remove %pre and %post scriptlets</li>
<li>Unless there is a good reason not to, remove %preun and %postun scriptlets</li>
<li>Empty the %files section</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../.." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../osg-build-tools/" title="OSG Build Tools" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                OSG Build Tools
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.30f6b8b1.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>